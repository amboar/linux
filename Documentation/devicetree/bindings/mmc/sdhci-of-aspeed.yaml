# SPDX-License-Identifier: GPL-2.0-or-later
%YAML 1.2
---
$id: http://devicetree.org/schemas/mmc/sdhci-of-aspeed.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: ASPEED SD/SDIO/eMMC Controller

maintainers:
  - Andrew Jeffery <andrew@aj.id.au>
  - Ryan Chen <ryanchen.aspeed@gmail.com>

description: |+
  The ASPEED SD/SDIO/eMMC controller exposes two slots implementing the SDIO
  Host Specification v2.00, with 1 or 4 bit data buses, or an 8 bit data bus if
  only a single slot is enabled.

  The two slots are supported by a common configuration area. As the SDHCIs for
  the slots are dependent on the common configuration area, they are described
  as child nodes.

properties:
  compatible:
    enum: [ aspeed,ast2400-sdc, aspeed,ast2500-sdc ]
  reg:
    description: Common configuration registers
  ranges: true
  clocks:
    maxItems: 1
    description: The SD/SDIO controller clock gate
  sdhci:
    type: object
    properties:
      compatible:
        allOf:
          - enum: [ aspeed,ast2400-sdhci, aspeed,ast2500-sdhci ]
          - const: sdhci
      reg:
        description: The SDHCI registers
      clocks:
        maxItems: 1
        description: The SD bus clock
      slot:
        allOf:
          - $ref: /schemas/types.yaml#/definitions/uint32
          - enum: [0, 1]
      interrupts:
        maxItems: 1
        description: The SD interrupt shared between both slots
    required:
      - compatible
      - reg
      - clocks
      - slot
      - interrupts

required:
  - compatible
  - reg
  - ranges
  - clocks

examples:
  - |
    #include <dt-bindings/clock/aspeed-clock.h>
    sdc@1e740000 {
            compatible = "aspeed,ast2500-sdc";
            reg = <0x1e740000 0x100>;
            #address-cells = <1>;
            #size-cells = <1>;
            ranges;
            clocks = <&syscon ASPEED_CLK_GATE_SDCLK>;

            sdhci0: sdhci@1e740100 {
                    compatible = "aspeed,ast2500-sdhci", "sdhci";
                    reg = <0x1e740100 0x100>;
                    slot = <0>;
                    interrupts = <26>;
                    sdhci,auto-cmd12;
                    clocks = <&syscon ASPEED_CLK_SDIO>;
            };

            sdhci1: sdhci@1e740200 {
                    compatible = "aspeed,ast2500-sdhci", "sdhci";
                    reg = <0x1e740200 0x100>;
                    slot = <1>;
                    interrupts = <26>;
                    sdhci,auto-cmd12;
                    clocks = <&syscon ASPEED_CLK_SDIO>;
            };
    };
